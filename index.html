<!DOCTYPE html>
<html>
<head>
  <title>Office Outing Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { color: #2c3e50; }
    form { margin-bottom: 30px; border: 1px solid #ccc; padding: 15px; border-radius: 5px; }
    label { display: block; margin-top: 10px; }
    input, select, button { padding: 8px; margin-top: 5px; width: 100%; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #f4f4f4; }
    b { display: block; margin-top: 5px; }
    p { margin-top: -10px; }
  </style>
</head>
<body>

  <h1>ðŸŽ‰ Office Outing Dashboard</h1>
  <p>
    Hey everyone! Weâ€™ll be visiting <b>Nature Trails Resort</b> for our office outing. 
    You can check out more details on their 
    <a href="https://www.naturetrails.in/" target="_blank">website</a> or view the 
    <a href="https://maps.app.goo.gl/4D3tUzZerDj7rniG6" target="_blank">Google Map location here</a>.
  </p>

  <h2>Create Carpool Group</h2>
  <form id="groupForm">
    <label>Group Name (Owner):</label>
    <input type="text" id="groupName" required>
    <label>Trigram:</label>
    <input type="text" id="groupTrigram" required>
    <label>Phone Number:</label>
    <input type="text" id="groupPhone" required>
    <label>Route From:</label>
    <input type="text" id="routeFrom" required>
    <label>Route To:</label>
    <input type="text" id="routeTo" required>
    <label>Total Seats in your car:</label>
    <input type="number" id="seats" required>
    <label>Return Type:</label>
    <select id="groupReturnType">
      <option value="Same Day">Same Day</option>
      <option value="Overnight">Overnight</option>
    </select>
    <button type="submit">Create Group</button>
  </form>

  <h2>Available Carpool Groups</h2>
  <table id="groupsTable">
    <thead>
      <tr>
        <th>Owner</th>
        <th>Trigram</th>
        <th>Phone</th>
        <th>Route</th>
        <th>Total Seats</th>
        <th>Remaining Seats</th>
        <th>Return Type</th>
        <th>Members</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Request to Join a Group</h2>
  <form id="requestForm">
    <label>Your Name:</label>
    <input type="text" id="requestName" required>
    <label>Group Name (Mention the group from the above list you wish to join for carpool):</label>
    <input type="text" id="requestGroup" required>
    <b>Kindly connect with the group owner on their mobile number or on their trigram through platform conversations before joining their group</b>
    <button type="submit">Request to Join</button>
  </form>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbz-QZdj5xVkAe3dsH6JT2YMmFy8ChTbjclmPBdfTcGKrdyzYEeVuEm6rQ9rJTJaHVn3oA/exec";

    async function fetchGroups() {
      const res = await fetch(API_URL);
      const data = await res.json();
      updateGroupsTable(data);
    }

    document.getElementById('groupForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const formData = {
        "Group Name (Owner)": document.getElementById('groupName').value,
        "Trigram": document.getElementById('groupTrigram').value,
        "Phone Number": document.getElementById('groupPhone').value,
        "Route From": document.getElementById('routeFrom').value,
        "Route To": document.getElementById('routeTo').value,
        "Route": `${document.getElementById('routeFrom').value} â†’ ${document.getElementById('routeTo').value}`,
        "Total Seats": parseInt(document.getElementById('seats').value),
        "Remaining Seats": parseInt(document.getElementById('seats').value),
        "Return Type": document.getElementById('groupReturnType').value,
        "Members": document.getElementById('groupName').value
      };

      await fetch(API_URL, {
        method: 'POST',
        body: JSON.stringify(formData),
        headers: { 'Content-Type': 'application/json' }
      });

      this.reset();
      fetchGroups();
    });

    function updateGroupsTable(groups) {
      const tbody = document.querySelector('#groupsTable tbody');
      tbody.innerHTML = '';
      groups.forEach(group => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${group["Group Name (Owner)"]}</td>
          <td>${group["Trigram"]}</td>
          <td>${group["Phone Number"]}</td>
          <td>${group["Route"]}</td>
          <td>${group["Total Seats"]}</td>
          <td>${group["Remaining Seats"]}</td>
          <td>${group["Return Type"]}</td>
          <td>${group["Members"]}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Load groups when the page loads
    fetchGroups();
  </script>

</body>
</html>
